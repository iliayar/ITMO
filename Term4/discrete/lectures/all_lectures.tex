% Created 2021-04-06 Tue 20:22
% Intended LaTeX compiler: pdflatex

\documentclass[oneside]{book}
\usepackage[T1, T2A]{fontenc}
\usepackage[lutf8]{luainputenc}
\usepackage[english, russian]{babel}
\usepackage{minted}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{natbib}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{caption}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{grffile}
\usepackage{extarrows}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage{placeins}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{capt-of}

\addto\captionsrussian{\renewcommand{\chaptername}{Лекция}}
 \usepackage{hyperref}
 \hypersetup{
     colorlinks=true,
     linkcolor=blue,
     filecolor=orange,
     citecolor=black,      
     urlcolor=cyan,
     }

\usetikzlibrary{decorations.markings}
\usetikzlibrary{cd}
\usetikzlibrary{patterns}
\usetikzlibrary{automata, arrows}

\newcommand\addtag{\refstepcounter{equation}\tag{\theequation}}
\newcommand{\eqrefoffset}[1]{\addtocounter{equation}{-#1}(\arabic{equation}\addtocounter{equation}{#1})}


\newcommand{\R}{\mathbb{R}}
\renewcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\A}{\mathfrak{A}}
\newcommand{\rank}{\mathop{\rm rank}\nolimits}
\newcommand{\const}{\var{const}}
\newcommand{\grad}{\mathop{\rm grad}\nolimits}

\newcommand{\todo}{{\color{red}\fbox{\text{Доделать}}}}
\newcommand{\fixme}{{\color{red}\fbox{\text{Исправить}}}}

\newcounter{propertycnt}
\setcounter{propertycnt}{1}
\newcommand{\beginproperty}{\setcounter{propertycnt}{1}}

\theoremstyle{plain}
\newtheorem{propertyinner}{Свойство}
\newenvironment{property}{
  \renewcommand\thepropertyinner{\arabic{propertycnt}}
  \propertyinner
}{\endpropertyinner\stepcounter{propertycnt}}
\newtheorem{axiom}{Аксиома}
\newtheorem{lemma}{Лемма}
\newtheorem{manuallemmainner}{Лемма}
\newenvironment{manuallemma}[1]{%
  \renewcommand\themanuallemmainner{#1}%
  \manuallemmainner
}{\endmanuallemmainner}

\theoremstyle{remark}
\newtheorem*{remark}{Примечание}
\newtheorem*{solution}{Решение}
\newtheorem{corollary}{Следствие}[theorem]
\newtheorem*{examp}{Пример}
\newtheorem*{observation}{Наблюдение}

\theoremstyle{definition}
\newtheorem{task}{Задача}
\newtheorem{theorem}{Теорема}[section]
\newtheorem*{definition}{Определение}
\newtheorem*{symb}{Обозначение}
\newtheorem{manualtheoreminner}{Теорема}
\newenvironment{manualtheorem}[1]{%
  \renewcommand\themanualtheoreminner{#1}%
  \manualtheoreminner
}{\endmanualtheoreminner}
\captionsetup{justification=centering,margin=2cm}
\newenvironment{colored}[1]{\color{#1}}{}

\tikzset{->-/.style={decoration={
  markings,
  mark=at position .5 with {\arrow{>}}},postaction={decorate}}}
\makeatletter
\newcommand*{\relrelbarsep}{.386ex}
\newcommand*{\relrelbar}{%
  \mathrel{%
    \mathpalette\@relrelbar\relrelbarsep
  }%
}
\newcommand*{\@relrelbar}[2]{%
  \raise#2\hbox to 0pt{$\m@th#1\relbar$\hss}%
  \lower#2\hbox{$\m@th#1\relbar$}%
}
\providecommand*{\rightrightarrowsfill@}{%
  \arrowfill@\relrelbar\relrelbar\rightrightarrows
}
\providecommand*{\leftleftarrowsfill@}{%
  \arrowfill@\leftleftarrows\relrelbar\relrelbar
}
\providecommand*{\xrightrightarrows}[2][]{%
  \ext@arrow 0359\rightrightarrowsfill@{#1}{#2}%
}
\providecommand*{\xleftleftarrows}[2][]{%
  \ext@arrow 3095\leftleftarrowsfill@{#1}{#2}%
}
\makeatother
\author{Ilya Yaroshevskiy}
\date{\today}
\title{Лекции по Дискретной математике 4 семестр}
\hypersetup{
 pdfauthor={Ilya Yaroshevskiy},
 pdftitle={Лекции по Дискретной математике 4 семестр},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 28.0.50 (Org mode 9.4.4)}, 
 pdflang={English}}
\begin{document}

\maketitle
\tableofcontents


\chapter{}
\label{sec:org193ee21}
\section{Производящие функции}
\label{sec:org94531e1}
Последовательность \(a_0, a_1, a_2, \dots\). Запишем в виде ряда
\[ A(t) = a_0 + a_1 t + a_2 t^2 + \dots \], где \(A(t)\) --- \textbf{производящая функция}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\item \(B(t) = b_0 + b_1 t + b_2 t + \dots\)
\end{itemize}
\[A(t) + B(t) = C(t)\]
\[ c_n = a_n + b_n \]
\[ C(t) = c_0 + c_1 t + c_2 t^2 + \dots \]
\end{property}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\item \(B(t) = b_0 + b_1 t + b_2 t + \dots\)
\end{itemize}
\[ A(t) \cdot B(t) = C(t) \]
\[ (a_0 + a_1 t + a_2 t^2 + \dots)\cdot(b_0 + b_1 t + b_2 t^2) = \]
\[ = a_0b_0 + (a_0 b_1 + a_1 b_0) t + (a_0 b_2 + a_1 b_1 + a_2 b_0) t^2 + \dots \]
\[ c_n = \sum_{k = 0}^n a_kb_{n - k} \]
\[ C(t) = c_0 + c_1 t + c_2 t^2 + \dots \]
\end{property}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\item \(B(t) = b_0 + b_1 t + b_2 t + \dots\), \(b_0 \neq 0\)
\end{itemize}
\[ \frac{A(t)}{B(t)} = C(t) \]
\[ C(t)\cdot B(t) = A(t) \]
\[ c_n = a_n - \sum_{k = 0}^{n - 1}c_k b_{n - k} \]
Если \(b_0 = 1\) и \(a_i, b_i \in \mathbb{Z}\), то \(c_i \in \mathbb{Z}\)
\end{property}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\end{itemize}
\[ A'(t) = a_1 + 2\cdot a_2 t + 3 \cdot a_3 t^2 + \dots \]
\[ a'_n = n\cdot a_n t^{n - 1} \]
\end{property}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\end{itemize}
\[ \int A(t) = a_0 t + \frac{1}{2} a_1 t^2 + \frac{1}{3} a_2 t^3 + \dots \]
\[ a'_n = \frac{1}{n + 1} \cdot a_n t^{n + 1} \]
\end{property}
\begin{property}
\-
\begin{itemize}
\item \(A(t) = a_0 + a_1 t + a_2 t + \dots\)
\item \(B(t) = b_0 + b_1 t + b_2 t + \dots\), \(b_0 = 0\)
\end{itemize}
\[ C(t) = A(B(t)) \]
\[ c_n = \sum_{k = 1}^n a_i \sum_{n=k_1 + k_2 + \dots + k_i} \prod_{j = 1}^i b_{k_j} \]
\end{property}
\chapter{}
\label{sec:org8c16762}
\section{Производящие функции}
\label{sec:orgd5f11c0}
\begin{definition}
\textbf{Полином} --- степенныой ряд, у которого начиная с некоторого места
 \(n\) все коэффиценты 0.
\end{definition}
\begin{symb}
\(\deg p = n\)
\end{symb}
\begin{definition}
\(\frac{P(t)}{Q(t)}\) --- \textbf{дробно рациональная функция}
\end{definition}
\subsection{Рекурентные соотношения}
\label{sec:org9afbd17}
\begin{definition}
\[ m: a_0, a_1, \dots, a_{m - 1} \]
\(k \le m, n \ge m\) \[ a_n = c_1a_{n-1} + \dots + a_ka_{n - k} \], где \(c_1, \dots, c_k\) --- коэффиценты рекурентности
\end{definition}
\begin{examp}
\-
\begin{itemize}
\item \(m = 2,\ k = 2\)
\item \(f_0 = f_1 = 1\)
\item \(c_1 = c_2 = 1\)
\end{itemize}
f\textsubscript{n} = f\textsubscript{n - 1} + f\textsubscript{n - 2} --- числа Фибоначи
\end{examp}


\begin{definition}
\textbf{Квазиполином}
\[ f(n) = \sum_{i = 1}^k p_i(n)r_i^n \], где \(p_i\) --- полином, \(r_i\) --- числа
\end{definition}
\begin{theorem}
\begin{itemize}
\item \(a_0, a_1, \dots, a_n, \dots\)
\end{itemize}
\uline{Тогда} эквивалентны:
\begin{enumerate}
\item \(A(t) = \frac{P(t)}{Q(t)}\), \(P, Q\) --- полиномы, \(q_0 \neq 0\)
\item для \(n \ge m\) \(a_n\) задается линейным рекурентным соотношением: \(a_n = c_1a_{n - 1} + \dots + c_ka_{n - k}\), причем:
\begin{itemize}
\item \(Q(t) = 1 - c_1t - c_2t^2 - \dots - c_kt^k\)
\item \(\deg P \le m - 1\)
\end{itemize}
\item \(a_n\) --- квазиполином \[ a_n = \sum_{i = 1}^k p_i(n)r_i^n \label{kvazi_1}\addtag \]
причем:
\begin{itemize}
\item \(r_i\) --- обратные величины корням \(Q(t)\)
\item \(k\) --- число различных его корней
\item \(\deg p_i = (\text{кратность корня}(r_i^{-1})) - 1\) \\
(\ref{kvazi_1} кроме \(\le m\) первых членов)
\end{itemize}
\end{enumerate}
\end{theorem}
\chapter{}
\label{sec:org3f4be40}
\newcommand{\vdomino}{
\begin{tikzpicture}
\draw (0, 0) rectangle (0.15,0.3);
\end{tikzpicture}}
\newcommand{\hdomino}{
\begin{tikzpicture}
\draw (0, 0) rectangle (0.3,0.15);
\draw (0, 0.15) rectangle (0.3,0.3);
\end{tikzpicture}}

\section{Производящие функции для объектов}
\label{sec:orga10c293}
\begin{itemize}
\item Оюъединение \\
\(A, B\ A \cap B = \emptyset\ C = A \cup B\) \\
\(A(t)\ B(t)\)
\[ C(t) = A(t) + B(t)\]
\[ c_n = a_n + b_n \]
\item Пара \\
\(C = A \times B\ \text{Pair}(A, B)\)
\[C(t) = A(t) \cdot B(t)\] 
\[ c_n = \sum_{i = 0}^na_nb_n \]
\item Последовательности \\
\(C = \text{Seq }A = A^0 \cup A^1 \cup A^2 \cup A^3 \cup \dots\ a_0 = 0\)
\[ C(t) = 1 + A(t) + A(t)\cdot A(t) + A(t)^3 + \dots \]
\[ C(t) = \frac{1}{1 - A(t)} \]
\item Множества \\
\(\varepsilon\) вес \(0\) \\
\(\text{Set }A = \bigtimes_{a \in A} (\varepsilon \cup a)\) \\
\[ C(t) = \prod_{a \in A}(1 + t^{\omega(a)}) = \prod_{k = 0}^\infty (1 + t^k)^{a_k} \]
\begin{examp}
\(\text{Set}\left\{\vdomino, \hdomino\right\}\ a_1 = 1,a_2 = 1\) \\
\[ C(t) = (1 + t)(1 + t^2) = t^3 + t^2 + t + 1 \]
\end{examp}
\item Мультимножества \\
\[\text{MSet} A = \bigtimes_{a \in A}(\varepsilon \cup a \cup a^2 \cup \dots) = \prod_{a \in A}\text{Seq}\{a\}\]
\[ C(t) = \prod_{a \in A}\frac{1}{1 - t^{\omega{a}}} = \prod_{k = 1}^\infty\left(\frac{1}{1 - t^k}\right)^{a_k} = \prod_{k = 1}^\infty(1 - t^k)^{-a_k}\]
\begin{examp}
\(\text{MSet}\{\vdomino, \hdomino\}\)
\[ C(t) = \frac{1}{(1 - t)(1 - t^2)} = \frac{1}{(1 - t^2)(1 + t)} \]
\[ c_n = dn + e + f\cdot(-1)^n \]
\end{examp}
\end{itemize}
\begin{examp}
\(\text{Seq}_{=k}(A) = A^k\) --- ровно 3 элемента \\
\(\text{Seq}_{\ge k}(A) = A^k \times \text{Seq}(A)\frac{A(t)^k}{1 - A(t)}\) \\
\(\text{Seq}_{\le k}(A) = \frac{1}{1 - A(t)} - \frac{A(t)^{k + 1}}{1 - A(t)} = \frac{1 - A(t)^{k + 1}}{1 - A(t)}\)
\end{examp}
\chapter{}
\label{sec:orgf3c7852}
\usetikzlibrary{automata}



\section{Производящие функции для регулярных языков}
\label{sec:org73faf08}
\(L\) --- регулярный язык
\[ | L \cap \Sigma^n | = a_n \] 
\[ L(t) = a_0 + a_1 t + \dots \]
\begin{remark}
\(L\) --- регулярная спецификация \\
\(\psi\) --- регулярное выражение:
\begin{enumerate}
\item \(L(\psi) = L\)
\item \(\forall x \in \L\ \exists !\) способ \(x\) удовлетворяющий \(\psi\)
\end{enumerate}
\end{remark}
\begin{lemma}
\(\Sigma\) --- конечный алфавит, \(L \subset \Sigma^*\) \\
\(L\) --- регулярная спецификация \(\Leftrightarrow\) \(L\) получаетя из \(\Sigma\):
\begin{enumerate}
\item Дизъюнктное объединение \(+\)
\item Прямое произведение \(\times\)
\item Последовательность Seq
\end{enumerate}
\end{lemma}
\begin{proof}
Общее рассжудение: по индукции рассмотрим для каждой операции во что
она перейдет, надо показать что единственность вывода сохраняется \color{red} Не работает \color{black}
\end{proof}
\begin{examp}
\[ ab^*|a^*b \]
\[ \color{blue}a \times \text{Seq }b\color{black}|\color{blue}\text{Seq } a \times b\color{black} \]
объединение дизъюнктное? \(\Rightarrow\) не регелярная спецификация
\end{examp}
\begin{examp}
\[ (ab^*)^* \]
\[ \color{blue} \text{Seq}(a \times \text{Seq } b) \color{black} \]
\end{examp}
\begin{theorem}
Если у \(L\) есть регулярная спецификация, то \(L\) --- дробно рациональная
\end{theorem}
\begin{theorem}[Производящая функция регулярного языка]
\(L\) --- регулярный язык над \(\Sigma\), ДКА \(A\): \\
\begin{itemize}
\item Состояния \(Q,\ |Q| = n\)
\item \(s \in Q\) --- стартовое сотояние
\item \(T \subset Q\) --- терминальные
\end{itemize}
\[ u = (\overbrace{0, 0, \dots, \underbrace{1}_s, 0, \dots, 0}^n) \]
\[ v = (\overbrace{0, \underbrace{1}_{\in T}, 0, \underbrace{1}_{\in T}, \dots, \underbrace{1}_{\in T}, 0}^n) \]

\[ D = (d_{ij})^T,\ d_{ij} = |\{c | i \xrightarrow[]{c} j\}| \]
\[ L(t) = \vec{u}(I - tD)^{-1}\vec{v} \]
\end{theorem}
\begin{examp}
Язык из слов, которые содержат abb как подстроку \\
\begin{center}
\begin{tikzpicture}
\node[state, initial] at (0, 0) (A) [circle] {\(0\)};
\node[state] at (2, 0) (B) [circle] {\(1\)};
\node[state] at (4, 0) (C) [circle] {\(2\)};
\node[state,accepting] at (6, 0) (D) [circle] {\(3\)};
\draw[->] (A) edge node[above] {a} (B);
\draw[->] (A) edge[loop above] node[above] {b} (A);
\draw[->] (B) edge[loop above] node[above] {a} (B);
\draw[->] (B) edge node[above] {b} (C);
\draw[->] (C) edge[loop above] node[above] {a} (B);
\draw[->] (C) edge node[above] {b} (D);
\draw[->] (D) edge[loop above] node[above] {a} (D);
\draw[->] (D) edge[loop right] node[below] {b} (D);
\end{tikzpicture}
\end{center}
\[ \begin{pmatrix} L_0 \\ L_1 \\ L_2 \\ L_3\end{pmatrix}  = \begin{pmatrix}0 \\ 0 \\ 0 \\ 1\end{pmatrix} + t \begin{pmatrix}1 & 1 & 0 & 0 \\ 0 & 1 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 0 & 0 & 0 & 2\end{pmatrix}\begin{pmatrix}L_0 \\ L_1 \\ L_2 \\ L_3\end{pmatrix}\]
\[ L_0 = \frac{t^3}{(1 - t)(1 - 2t)(1 - t - t^2)} \]
\end{examp}
\section{Автомат КМП и автокор. многочлен}
\label{sec:orgf1cf229}
Конструкция Гуибаса-Одлызко
\[ p = \fbox{p_1, p_2, \dots, p_k} \]
\[ c_i = [p[i+1\dots k] = p[1\dots k-i]] \]
\[ c(t) = c_0 + c_1 t + c_2 t^2 + \dots + c_{k - 1}t^{k - 1} \]
\begin{examp}
\(p = \text{aabbaa}\) \\
\(c = (1, 0, 0, 0, 1, 1)\) \\
\(c(t) = 1 + t^4 + t^5\)
\end{examp}
\begin{theorem}
\-
\begin{itemize}
\item \(\Sigma,\ |\Sigma| = m\)
\end{itemize}
\(S_n\) --- количество слов длины \(n\), не содержащих \(p\)
\[ S(t) = s_0 + s_1t + s_2t^2 + \dots \]
\[ S(t) = \frac{c(t)}{t^k + (1 - mt)c(t)} \]
\end{theorem}
\begin{examp}
\(p = \text{abb}\)
\[ c(t) = 1 \]
\[ \frac{1}{t^3 + (1 - 2t)\cdot 1} = \frac{1}{1 - 2t + t^3} \]
\end{examp}

\subsection{Пентагональная формула Эйлера}
\label{sec:org3227096}
\[ p_0\ p_1\ p_2\ \dots\ p_n\ \dots \]
\(p_n\) --- количество разбиений \(n\) на слагаемые из \(\N\). Порядок не важен
\begin{itemize}
\item \(U = \{0\},\ u_1= 1,\ U(t) = t\)
\item \(N = \text{Seq}^+U=\)положительно целые числа
\item \(P = \text{MSet }N\)
\[ P(t) = \prod_{k = 1}^\infty \frac{1}{1 - t^k} \]
\end{itemize}
\[ Q(t) = \prod_{k = 1}^\infty (1 - t^k) \]
\[ R(t) = \prod_{k = 1}^\infty(1 + t^k)\ [t^n]R \to r_n \]
\(r_n\) --- количество разбиений на различные слагаемые
\[ [t^n]Q = \sum_{\substack{\text{разбиение } n \text{ на } \\ \text{различные слагаемые}}} (-1)^\text{число слагаемых} \]
\[ q_n = e_n - o_n \]
\(e_n\) --- число разбиений на четное число различных слагаемы, \(o_n\) --- число разбиений на нечетное число различных слагаемы, 
\begin{theorem}
\[ Q(t) = 1 + \sum_{k = 1}^\infty (-1)^k(t^{\frac{3k^2 - k}{2}} + t^{\frac{3k^2 + k}{2}}) \]
\end{theorem}
\begin{lemma}
\[ n \neq \frac{ek^2 \pm k}{2}, \text{то } e_n = o_n \]
\[ n = \frac{ek^2 \pm k}{2}, \text{то } e_n = o_n + (-1)^k \]
\end{lemma}
\chapter{}
\label{sec:org46c7cf8}
\newcommand{\Seq}{\text{Seq}\,}
\newcommand{\Set}{\text{Set}\,}
\newcommand{\Cyc}{\text{Cyc}\,}

\section{Помеченные КО и экспоненциальные производящие функции}
\label{sec:org316d5c5}
\[ a_0\ a_1\ a_2\ \dots\ a_n\ \dots\quad A(t) = a_0 + a_1 t + a_2 t^2 + \dots + a_nt^n + \dots \]
\begin{definition}
Экспоненциальная производящая функция:
\[ a(t) = \frac{a_0}{0!} + \frac{a_1}{1!}\cdot t + \frac{a_2}{2!}\cdot t^2 + \dots + \frac{a_n}{n!}\cdot t^n + \dots \]
\end{definition}
\begin{symb}
Мы будет обозначать ЭПФ так-же большой буквой
\end{symb}
\begin{examp}
\(1, 1, 1,1, ,1,1 ,1, 1, 1\)
\begin{description}
\item[{ОПФ}] \(\frac{1}{1 - t}\)
\item[{ЭПФ}] \(1 + 1\cdot t + \frac{1}{2!}\cdot t^2 + \frac{1}{3!}\cdot t^3 + \dots = \sum\limits_{n = 0}^{ + \infty} \frac{1}{n!}\cdot t^n = e^t = \exp(t)\)
\end{description}
\end{examp}
\begin{examp}
\(1, 1, 2, 6, 24, \dots, n!, \dots\quad a_n = n!\)
\begin{description}
\item[{ОПФ}] \(1 + t + 2\cdot t^2 + 6\cdot t^3 + \dots + n!\cdot t^n + \dots\)
\item[{ЭПФ}] \(\sum \limits_{n = 0}^{ + \infty} \frac{n!}{n!}\cdot t^n = \frac{1}{1 - t}\)
\end{description}
\end{examp}

\[ A(t) = \frac{a_0}{0!} + \frac{a_1}{1!}\cdot t + \frac{a_2}{2!}\cdot t^2 + \dots + \frac{a_n}{n!}\cdot t^n + \dots \]
\[ B(t) = \frac{b_0}{0!} + \frac{b_1}{1!}\cdot t + \frac{b_2}{2!}\cdot t^2 + \dots + \frac{b_n}{n!}\cdot t^n + \dots \]

\begin{property}
\[ C(t) = A(t) \pm B(t)\quad c_n = a_n \pm b_n \]
\end{property}
\begin{property}
\[ C(t) = a(t)\cdot B(t) \]
\[ \frac{C_n}{n!} = \sum\limits_{k = 0}^n \frac{a_k}{k!}\cdot\frac{b_{n - k}}{(n - k)!} \]
\[ c_n = \sum\limits_{k = 0}^n \binom{n}{k}a_kb_{n - k} \]
\end{property}
\begin{property}
\[ C(t) = \frac{A(t)}{B(t)} \]
\[ a_n = \sum^n_{k = 0}\binom{n}{k}b_kc_{n - k} = \sum\limits_{k = 1}^n \binom{n}{k} b_k c_{n - k} + b_0 c_n \]
\[ c_n = \frac{a - \sum_{k = 1}^n\binom{n}{k} b_k c_{n - k}}{b_0} \]
\end{property}
\textbf{Далее все производящие функции --- экспоненциальные, а объекты помеченые}
\subsection{Помеченные объекты}
\label{sec:orga24b7ca}
\begin{examp}
Перестановк. \(P_n = n!\) --- количество перестановок из \(n\) элементов
\end{examp}
\begin{examp}
Пустые графы. \(E_n = 1\) --- количество графов с \(n\) вершинами \\
ЭПФ: \(\exp(t)\)
\end{examp}
\begin{examp}
Циклы. \(C_n = (n - 1)!\) --- количество циклов из \(n\) вершин. Направление обхода фиксировано. \\
ЭПФ: \(\sum\limits_{n = 1}^{ + \infty} \frac{n!}{n}\cdot \frac{1}{n!}\cdot t^n = \sum\limits_{n = 1}^{ + \infty} \frac{t^n}{n} = \ln \frac{1}{1 - t}\)
\end{examp}
\subsection{Операции}
\label{sec:org96c6913}
\begin{enumerate}
\item Дизъюнктное объединение (сумма)
\label{sec:org11ae30d}
\begin{itemize}
\item \(A\)
\item \(B\)
\item \(A \cap B = \emptyset\)
\item \(C = A \cup B\)
\end{itemize}
\[ c_n = a_n + b_n\quad C(t) = A(t) + B(t) \]
\item Пара (произведение)
\label{sec:orge471746}
\begin{itemize}
\item \(A\)
\item \(B\)
\item \(C = A \times B\)
\end{itemize}
\[ C = \{\langle \underbrace{a}_{k\text{ атомов}}, \underbrace{b}_{n - k\text{ атомов}} \rangle\} \]
Получим последовательность \(c_1 c_2 \dots c_n\). Перенумеруем элементы: \\
Первые \(k\) в \(d_1d_2 \dots d_k\), где \(d_i = |\{c_j | 1 \le j \le k,\ c_k \le c_i\}|\). \\
А остальные \(c_{k + 1}\dots c_n\) в \(e_1 \dots e_{n - k}\), где \(e_i = |\{c_j | k + 1\le j \le n,\ c_j \le c_{i + k}\}|\). \\
Пусть \(d_i = a_i\), а \(e_i = b_i\)
\[ c_n = \sum_{k = 0}^{ n } \binom{n}{k} a_k b_{n - k} \quad C(t) = A(t) \cdot B(t)\]
\begin{examp}
Пары перестановок. \(C(t) = \frac{1}{(1 - t)^2}\). Тогда \(c_n = (n + 1)n!\)
\end{examp}
\item Последовательность
\label{sec:org7847e22}
\[ C = \Seq A = \emptyset + A \times \Seq A \]
\[ C(t) = 1 + A(t)\cdot C(t) \]
\[ C(t) = \frac{1}{1 - A(t)} \]
\begin{examp}
\-
\begin{itemize}
\item \(U = \{\circ\}\)
\item \(U(t) = t\)
\item \(\Seq U = P\)
\end{itemize}
\[P(t) = \frac{1}{1 - t}\]
\end{examp}
\item Множества (Set)
\label{sec:org59ff88b}
\begin{itemize}
\item \(\Set_k A\) ---  множества, содержащие \(k\) обхектов
\end{itemize}
\[ B_k = \Seq_k A = \underbrace{A \times A \times \dots \times A}_k\quad B_k(t) = A(t)^k \]
\[ \Set_k A = \Seq_k A /_\sim\]
\([x_1 x_2 \dots x_k] \sim [y_1 y_2 \dots y_k]\). \(\exists\) перестановка \(\pi: x_i = y_{\pi[i]}\)
\[ C_k(t) = \frac{1}{k!}\quad B_k(t) = \frac{A(t)^k}{k!} \]
\[ \Set A = \bigcup_{k = 0}^{\infty} \Set_k A = \sum_{k = 0}^\infty \frac{A(t)^k}{k!} = e^{A(t)} \]
\begin{examp}
\-
\begin{itemize}
\item \(U = \{\circ\}\)
\item \(U(t) = t\)
\end{itemize}
\[ \Set U = E\quad E(t) = e^t \]
, где \(E\) --- пустые графы
\end{examp}
\begin{examp}
Циклы.
\begin{itemize}
\item \(U = \{\circ\}\)
\item \(U(t) = t\)
\item \(B = \Set \Cyc U\)
\end{itemize}
\[ B(t) = e^{C(t)} = e^{\ln \frac{1}{1 - t}} = \frac{1}{1 - t} \]
Набор помеченных циклов являеся престановкой
\end{examp}
\item Циклы
\label{sec:org2cbf76c}
\begin{itemize}
\item \(\Cyc_k A\) --- количество циклов длины \(k\)
\end{itemize}
\[ C = \Cyc_k A = \Seq_k A /_\sim \], где классы эквивалентности с точностью до циклических сдвигов. \\
\([x_1\dots x_k] \sim [y_1 \dots y_k]\). \(\exists i:\ x_j = y_{(i + j)\mod k + 1}\)
\[ \Cyc U = \ln\frac{1}{1 - t} \]
\[ C_k(t) = \frac{1}{k}A(t)^k \]
\[ C(t) = \sum_{k = 1}^\infty \frac{1}{k} A(t)^k = \ln\frac{1}{1 - A(t)} \]
\[ \Set\Cyc U = P \]
\[ \Set \Cyc A \simeq \Seq A \]
\end{enumerate}


\subsection{Обобщение}
\label{sec:org868403b}

\begin{theorem}[о подстановке]
\-
\begin{itemize}
\item \(A\) --- помеченные КО --- \(A(t)\)
\item \(B\) --- помеченные КО --- \(B(t)\)
\end{itemize}
\(C = A[B]\) --- вместо каждого атома \(A\) подставляем КО \(B\), перенумеруем получившиеся атомы произвольным образом
\[ C(t) = A(B(t)) \]
\end{theorem}
\begin{examp}
\(A\times A\) --- пара атомов. Их две \(B(t) = t^2 = 2 \cdot \frac{1}{2!} \cdot t^2\). Подставляем \(B(A(t)) = A(t)^2\)
\end{examp}
\chapter{}
\label{sec:orgb2c435a}
\newcommand{\stirlF}[2]{\left[\begin{matrix} #1 \\ #2 \end{matrix}\right]}
\newcommand{\stirlS}[2]{\left\{\begin{matrix} #1 \\ #2 \end{matrix}\right\}}
\newcommand{\Set}{\text{Set}\,}
\newcommand{\Seq}{\text{Seq}\,}
\newcommand{\Cyc}{\text{Cyc}\,}


Рассмотрим деревья:
\[ T = t \times \Text{Seq}\,T \]
, где \(t\) --- корень
\[ A(t) = t\cdot \phi(A(t)) \]
\[ \phi(s) = \frac{1}{1 - s} \]
Решить это уравнение в общем виде можно с помощью формулы Лагранжа
\begin{theorem}[формула обращения Лагранжа]
\[ a_n = \frac{1}{n}\cdot[s^{n - 1}](\phi(s))^n \], где \([s^{n}]A(s)\) --- коэффицент при \(s^n\) в \(A(s)\)
\[ A(t) = \sum_{n = 0}^\infty a_n t^n \]
\end{theorem}
\begin{examp}
Применим ее для деревьев
\[ a_n = \frac{1}{n}\cdot[s^{n - 1}]\left(\frac{1}{1 - s}\right)^n \]
\[ \left(\frac{1}{1 - s}\right)^n = (1 + s + s^2 + s^3 + \dots + s^k + \dots)^n \]
\[ (1 - s)^{-n} = 1 - \binom{-n}{1} s + \binom{-n}{2}s^2 - \binom{-n}{3}s^3 \]
\[ \binom{-n}{n - 1} = \frac{-n\cdot(-n - 1)\cdot(-n - 2)\cdot\dots\cdot(-n - (n - 1) + 1)}{1\cdot 2 \cdot 3 \cdot \dots \cdot (n - 1)} \]
\[ \frac{1}{n}(-1)^{n - 1}\binom{-n}{n - 1} = \frac{(2n - 2)!}{(n - 1)!n!} = \binom{2n - 2}{n - 1} \]
\end{examp}
\begin{examp}
\[ \phi(s) = e^s \]
\[ \frac{a_n}{n!} = \frac{1}{n}\cdot[s^{n- 1}] e^{ns} \]
\[ e^{ns} = 1 + \frac{1}{1!}(ns) + \frac{1}{2!}(ns)^2 + \frac{1}{3!}(ns)^3 + \dots \]
\[ [s^{n - 1}]e^{ns} = \frac{n^{n - 1}}{(n - 1)!} \]
\end{examp}
\section{Производящая функция от нескольких перменных}
\label{sec:org28fc36e}
\(\binom{n}{k}\) образуют таблицу:
\begin{center}
\begin{tabular}{l|rrrll}
\(n\textbackslash k\) &  &  &  &  & \\
\hline
 & 1 &  &  &  & \\
 & 1 & 1 &  &  & \\
 & 1 & 2 & 1 &  & \\
 & 1 & 3 & 3 & 1 & \\
 & 1 & 4 & 6 & 4 & 1\\
\end{tabular}
\end{center}
\[ A_k(t) = \sum_{n = 0}^\infty \binom{n}{k}t^n \]
\[ B_n(t) = \sum_{n = 0}^\infty \binom{n}{l}t^k \]
\[ C(u ,z) = \sum_{n, k}\binom{n}{k}z^nu^k = \frac{1}{1 - z - uz}\]
Посмотрим на \(C(u, z)\) так: \(n\) --- вес, \(k\) --- стоимость. Будем считать, что \(z\) --- не берем объект, \(uz\) --- берем объект
\[ \text{Seq}\,\{z, uz\} = [], [z], [uz], [z, z], [z, uz], [uz, z], [uz, uz], \dots \]
\[ A(u, z) = z + uz \]
\subsection{Числа Стирлинга I рода}
\label{sec:org2cffbc0}
\fixme \\
Помеченные перстановки, \(\text{Set}\,\text{Cyc}\,Z\)
\[ \bigcup_{k = 0}^\infty \text{Set}_{=k}\text{Cyc}\, Z \]
\[ \text{Set}\,\text{Cyc}\,Z = e^{\ln\frac{1}{1 - Z}} = \frac{1}{1 - Z} \]
\[ \bigcup_{k = 0}^\infty \text{Set}_{= k}\left(u \times \text{Cyc}\,Z\right) \mapsto \sum_{n ,k}\stirlF{n}{k}\frac{1}{n!}z^nu^k\]
\[ \Set_{=k}(A) = \frac{\Seq_{=k}(A)}}{k!} = \frac{A(Z)^k}{k!}  \]
\[ u \times \Cyc Z = \sum_{n = 0}^\infty \frac{\left(u \ln \left(\frac{1}{1 - Z}\right)\right)^k}{k!} = e^{u\ln\frac{1}{1 - Z}} = (1 - Z)^{-u}\]
\[ (1 - Z)^{-u} = \sum_{n,k}\frac{\stirlF{n}{k}}{n!} Z^n u^k \]
\subsection{Числа Стирлинга II рода}
\label{sec:orgcaf2109}
\[ \stirlS{n}{k}\quad \Set\Set_{>0} Z \]
\[ \bigcup_{k = 0}^\infty\Set_{=k}(u\times \Set_{>0}Z) \]
\[ \sum_{k = 0}^\infty \frac{\left(u(e^Z - 1)^k\right)}{k!} = e^{ue^Z - u} = \sum_{n,k} \frac{\stirlS{n}{k}}{n!}z^nu^k\]
\subsection{Средняя стоимоть}
\label{sec:org6a01f39}
\begin{itemize}
\item \(A\quad a_{n,k} = [z^nu^k]A(u, z)\) --- количество объектов веса \(n\) стоимости \(k\)
\end{itemize}
\[ w_n = \frac{\sum_{k = 0}^\infty k a_{n,k}}{\sum_{k = 0}^\infty a_{n, k}} = \frac{\left.[z^n]\left(\frac{\partial}{\partial u}A(u ,z)\right)\right|_{u = 1}}{[z^n]A(1, z)}\]
\begin{enumerate}
\item Разбиение на слагаемые, порядок важен
\label{sec:org144b6d6}
Аналогично рассотовке перегорожок, \(\Seq\Seq_{>0}Z\)
\[ \Seq \left(u\times\Seq_{>0}Z\right) \]
\[ \frac{1}{1 - z} - 1= \frac{z}{1 - z} \]
\[ A(u, z) =  \frac{1}{1 - \frac{uz}{1 - z}} = \frac{1 - z}{1 - z - uz} \]
\[ \frac{\partial A(u,z)}{\partial u}\bigg|_{u = 1} = \frac{z(1 - z)}{(1 - z- uz)^2} \bigg|_{u = 1} = \frac{z(1 - z)}{(1 - 2z)^2}\]
\begin{description}
\item[{Числитель}] \[ [z^n]\frac{z(1 - z)}{(1 - 2z)^2} = \frac{2^n(n + 1)}{4} \]
\item[{Знаменатель}] \[ [z^n]\frac{1 - z}{1 - 2z} = 2^n - 2^{n - 1} = 2^{n - 1} \]
\end{description}
Среднее число слагаемых: \[ \frac{2^n(n + 1)}{2^{n - 1}\cdot4} = \frac{n + 1}{2} \]
\item Среднее число циклов в перестановке
\label{sec:org44f693d}
\[ A(u ,z) = (1 - z)^{- u} \]
\[ \frac{\partial}{\partial u}A(u, z) = \frac{\partial}{\partial u} e^{u \ln\frac{1}{1 - z}} = \ln \frac{1}{1 - z}\cdot e^{u\ln\frac{1}{1 -z }} \]
Подставляем \(u = 1\):
\begin{description}
\item[{Числитель}] \[ [z^n]\frac{\ln \left(\frac{1}{1 - z}\right)}{1 - z} = B(z)\]
\item[{Знаменатель}] \[ (1 - z)^{-u}\bigg_{u = 1} = \frac{1}{1 - z} \]
\[ [z^n]\frac{1}{1 - z} = 1 \]
\end{description}
\[ (z + \frac{1}{2}z^2 + \frac{1}{3}z^3 + \dots + \frac{1}{k}z^k + \dots)\cdot(1 + z + z^2 + \dots) \]
\[ [z^n]B(z) = \sum_{k = 1}^n \frac{1}{k} = H_n \sim \log n \]
\end{enumerate}
\end{document}
